<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>更改页面</title>
    <link rel="stylesheet" href="../../layui/css/layui.css" media="all">
    <link href="../../css/bootstrap/3.3.6/bootstrap.min.css" rel="stylesheet">
    <script src="../../JS/jquery.min.js" ></script>
    <script src="../../layui/layui.js"></script>
    <script src="../../JS/bootstrap/bootstrap.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#btn").click(function () {
                var password = $('#password').val();
                var new_pass = $('#new_pass').val();
                var confirm_pass = $('#confirm_pass').val();
                if (confirm_pass == new_pass){
                        $.ajax({
                            type: "post",
                            url: "/up_pass",
                            data: {
                                "id":sessionStorage.getItem("id"),
                                "password":password,
                                "new_pass":new_pass
                            },
                            success:function (data) {
                                if (data.code > 200){
                                    alert(data.message);
                                    //alert(data.message);
                                    location.reload();//密码更改完毕后刷新页面
                                }
                                else {
                                    if (data.code < 200 && data.code > 100) {
                                        alert(data.message);
                                    }
                                    else
                                    {
                                        alert(data.message);
                                    }
                                }
                            },
                            error:function (arg1) {
                                alert("系统异常");
                                console.log(arg1);
                            }
                        });
                }
                else {
                    alert("请保持两次密码一致");
                }
            });

        });

    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#username").text(sessionStorage.getItem("name"));
        });
        function getRoles() {
            $.ajax({
                type:"post",
                url:"/getRoles",
                contentType: 'application/json;charset=utf-8',
                success:function (data) {
                    if (data.code > 200){
                        window.location.href = "Info_FeedBack.html"
                    }
                    else {
                        alert(data.message);
                    }
                }
            })
        }
        function logout() {
            $.ajax({
                type: "post",
                url: "/logout",
                contentType: 'application/json;charset=utf-8',
                success:function (data) {
                    if (data.code > 200) {
                        window.location.href = "../../index.html"
                    }
                    else {
                        alert(data.message);
                    }
                }
            })
        }
    </script>
    <style>
        body{
            padding-top: 80px;
            padding-bottom: 50px;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top">
    <div style="height: 100%;width: 100%;">
        <div style="height: 70%;width: 100%;">
            <h2 style="color: #0066FF;float: left">XCK程序栈</h2>
            <p style="color: #080808;float: right">欢迎您：<span id="username"></span>同学  | <a href="#" onclick="logout()" style="color: #080808">退出</a></p>
        </div>
        <div style="height: 30%;width: 100%;">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">网上选课<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="../../include/student/Extracurricular.html">课外选修课</a></li>
                        <li><a href="../../include/student/Sports.html">体育选修课</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">信息维护<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="../../include/student/info.html" >个人信息</a></li>
                        <li><a href="../../include/student/Change_Pass.html">密码修改</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">信息查询<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="course.html">课表查询</a></li>
                        <li><a href="../../include/student/test.html">考试查询</a></li>
                        <li><a href="../../include/student/score1.html">成绩查询</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">信息反馈<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#" onclick="getRoles()">信息反馈</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>


<form class="layui-form">
    <div class="layui-form-item">
        <label class="layui-form-label">旧密码</label>
        <div class="layui-input-block">
            <input type="password" name="password" id="password" placeholder="请输入旧密码" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">新密码</label>
        <div class="layui-input-block">
            <input type="password" name="new_pass" id="new_pass" placeholder="请输入新密码" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">确认密码</label>
        <div class="layui-input-block">
            <input type="password" name="confirm_pass" id="confirm_pass" placeholder="请再次输入新密码" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <div class="layui-input-block">
            <button type="button" class="layui-btn"  id="btn">立即提交</button>
        </div>
    </div>

</form>

<nav class="navbar navbar-default navbar-fixed-bottom">
    <div style="text-align: center">
        <p style="color: #080808;size: 12px">2020-2030 @版权所有 xck栈  联系我们：23332333</p>
    </div>
</nav>

</body>
</html>